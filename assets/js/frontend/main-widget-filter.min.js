!function(e){"use strict";function t(){var t=new Map,a=e(".product-taxonomy");return"feature"===a.data.keys&&a.find("> li").each(function(){var a=e(this).attr("class").match(/\d+/)[0];if(e(this).find(".children").length){var i=[];e(this).find(".children > li").each(function(){var t=e(this).attr("class").match(/\d+/)[0];i.push(t)}),t.set(a,i)}else t.set(a,a)}),t}var a=Main_Widget_Filter.current_page;if(e(".taxonomy-filter").length){e(".taxonomy-filter").hasClass("product_cat")||e(".taxonomy-filter ul.children").parent().addClass("no-filter"),e(".taxonomy-filter").on("click","a",function(i){var n=e(this).parent();n.find(" > ul").attr("class");i.preventDefault();var r=window.location.href,s=e(this).parent().attr("class").match(/\d+/)[0],l=e(this).parents(".taxonomy-filter").data("keys"),c=r.split("/?")[1],o=r.split("/?")[0];null!==a&&(o=a);var d=t();if(e(this).parent().hasClass("active"))c=-1===c.indexOf(",")?c.replace("_"+l+"="+s,""):"feature"===l?c.replace(s+",","").replace(","+s,""):c.replace("_"+l+"="+s,""),c=c.replace("?&","?");else if(void 0!==c)if("feature"===l&&-1!==c.indexOf(l)){var p=c.match(/\b(\w+)=(\d+)\b/g);p=-1!==c.indexOf("&")?c.split("&"):[c];var h="";e.each(p,function(t,a){if(-1===a.indexOf(l))h+=""===h?a:"&"+a;else if(-1===a.indexOf(",")){var i=a.split("=")[1];if(d.has(i)&&d.has(s))""===h?h="_"+l+"="+i+","+s:h+="&_"+l+"="+i+","+s;else if(d.has(s)&&!d.has(i)){var n=d.get(s);-1===e.inArray(i,n)?""===h?h="_"+l+"="+i+","+s:h+="&_"+l+"="+i+","+s:""===h?h="_"+l+"="+s:h+="&_"+l+"="+s}else if(d.has(i)&&!d.has(s)){var r=d.get(i);-1===e.inArray(s,r)?""===h?h="_"+l+"="+i+","+s:h+="&_"+l+"="+i+","+s:""===h?h="_"+l+"="+s:h+="&_"+l+"="+s}else{var c=e(".cat-item-"+s).parent(".children").parent().attr("class"),o=e(".cat-item-"+i).parent(".children").parent().attr("class");c===o?""===h?h="_"+l+"="+s:h+="&_"+l+"="+s:""===h?h="_"+l+"="+i+","+s:h+="&_"+l+"="+i+","+s}}else{var p=a.split("=")[1].split(",");if(d.has(s)){var f=d.get(s);e.each(p,function(t,i){-1!==e.inArray(i,f)&&(""===h?h=a.replace(i,s):h+="&"+a.replace(i,s))})}else{var u="",w=[];e.each(p,function(t,a){var i=d.get(a),n=e(".cat-item-"+s).parent(".children").parent().attr("class"),r=e(".cat-item-"+a).parent(".children").parent().attr("class");void 0!==i?(w.push("yes"),-1!==e.inArray(s,i)&&(u=a)):(w.push("no"),n===r&&(w.push("yes"),u=a))}),""!==u&&-1!==e.inArray("yes",w)?""===h?h=a.replace(u,s):h+="&"+a.replace(u,s):""===h?h=a+","+s:h+="&"+a+","+s}}}),c=h}else if("product_cat"===l)c="_"+l+"="+s;else if(c=c.replace(/(&?)_feature=[0-9,?]+/,""),c=c.replace(/(&?)_product_tag=[0-9,?]+/,""),-1===c.indexOf("&")){var f=c.split("=")[0].replace("_","");c=l===f?"_"+f+"="+s:c+"&_"+l+"="+s}else{var u=c.split("&"),w=[],g="";e.each(u,function(e,t){w.push(t.split("=")[0].replace("_",""))}),-1!==e.inArray(l,w)?(c="",e.each(w,function(e,t){l===t&&(g=e)}),e.each(u,function(e,t){c+=g===e?""!==c?"&_"+l+"="+s:"_"+l+"="+s:""!==c?"&"+t:t})):c=c+"&_"+l+"="+s}else c="_"+l+"="+s;e(this).parents(".product-taxonomy").hasClass("dropdown")&&e(this).parent().find(".children").length&&!e(this).parent().hasClass("open")||(""!==c?null!==a?-1===o.indexOf("?")?window.location.href=o+"?"+c:window.location.href=o+"&"+c:window.location.href=o+"/?"+c:window.location.href=o)});var i=window.location.href,n=i.split("/?")[1],r=i.split("/?")[0];if(void 0!==n){var s='<div class="widget widget-box-selection"><span class="widget-title shop-sidebar">'+Main_Widget_Filter.label_box_selected+'</span><a href="'+r+'" class="remove-filter">'+Main_Widget_Filter.label_remove+"</a>",l=n.match(/\b(\d+)\b/g),s=s+"<ul>";e.each(l,function(t,a){var i=e(".taxonomy-filter .cat-item-"+a),n=i.parents("ul.taxonomy-filter").data("keys");i.addClass("active"),i.find("> a").append('<i class="fa fa-times-circle"></i>'),e(".product-taxonomy").hasClass("dropdown")&&(e(".taxonomy-filter .active").parents(".children").addClass("open"),e(".taxonomy-filter .active").parents(".children").parent().addClass("open")),void 0!=i.find(" > a").html()&&(s=s+'<li class="cat-item cat-item-'+a+'" data-selected="_'+n+"="+a+'"><a href="#">'+i.find(" > a").html()+"</a></li>")}),s+="</ul></div>",e(".widget").parent().find(".widget-taxonomy-menu").first().before(s),e(".widget-box-selection ul").on("click","li",function(t){t.preventDefault();var a=e(this).data("selected"),n=new RegExp("(&?)"+a+"(&?)"),r=i.replace(n,"");r=r.split("/?")[1]?r:r.split("/?")[0],window.location.href=r})}}e(".widget .dropdown").length&&(e(".widget .dropdown").hasClass("cat_hide")&&(e(".widget .dropdown.cat_hide").prev(".widget-title").addClass("has_current_cat"),e(".widget .has_current_cat").click(function(){e(this).toggleClass("active"),e(this).next().slideToggle()})),e(".widget .dropdown").on("click","a",function(t){if(e(this).parent().find(".children").length){if(e(this).parent().hasClass("open"))return!0;t.preventDefault(),e(".widget .dropdown .children").parent().hasClass("open")&&!e(this).parents(".children").parent("li").hasClass("open")&&(e(".widget .dropdown .children").slideUp(),e(".widget .dropdown .children").parent().removeClass("open")),e(this).parent().find(" > .children").slideToggle(),e(this).parent().toggleClass("open")}}),e(".current-cat-ancestor").length&&e(".current-cat-ancestor").addClass("open"),e(".widget .dropdown .current-cat").length&&e(".widget .dropdown .current-cat").addClass("open")),e(".widget .wc-filter-search").length&&e(".widget .wc-filter-search").on("keyup","input",function(t){t.preventDefault();var a=e(this).val().toLowerCase(),i=e(this).parent(".wc-filter-search").next(".product-taxonomy");i.find("a").each(function(e,t){t.textContent.toLowerCase().match(a)?t.parentNode.style.display="block":t.parentNode.style.display="none"})})}(jQuery);
